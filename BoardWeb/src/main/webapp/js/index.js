
let json = "[{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0014/A00000014269519ko.jpg?l=ko\",\"prdName\":\"오쏘몰 이뮨 멀티비타민&amp;미네랄 7입 (1주분)\",\"prodPrice\":\"34,000\",\"prodCode\":\"A000000142695\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018908729ko.jpg?l=ko\",\"prdName\":\"[3만원 이상 구매시 보조배터리 증정]아임비타 멀티비타민 이뮨샷 12+2입 증정기획 (14일분)\",\"prodPrice\":\"31,900\",\"prodCode\":\"A000000189087\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0019/A00000019308608ko.jpeg?l=ko\",\"prdName\":\"오쏘몰 이뮨 멀티비타민&amp;미네랄 14입+2입(오쏘몰 바이탈 M/F 증정기획)\",\"prodPrice\":\"75,000\",\"prodCode\":\"A000000193086\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0000/A00000000294405ko.jpg?l=ko\",\"prdName\":\"고려은단 비타민C1000 120정 (4개월분)\",\"prodPrice\":\"15,000\",\"prodCode\":\"A000000002944\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0015/A00000015097708ko.jpg?l=ko\",\"prdName\":\"센트룸 멀티 구미 40정 (20일분)\",\"prodPrice\":\"12,000\",\"prodCode\":\"A000000150977\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0016/A00000016473602ko.jpg?l=ko\",\"prdName\":\"고려은단 비타민C1000 이지+비타민D 120정 (60일분)\",\"prodPrice\":\"10,900\",\"prodCode\":\"A000000164736\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0016/A00000016657404ko.jpg?l=ko\",\"prdName\":\"고려은단 멀티비타민 올인원 30정 (30일분)\",\"prodPrice\":\"14,900\",\"prodCode\":\"A000000166574\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018563401ko.jpg?l=ko\",\"prdName\":\"뉴칸 더블파워 밀크씨슬+멀티비타민 30개입 (30일분)\",\"prodPrice\":\"98,000\",\"prodCode\":\"A000000185634\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018103302ko.jpg?l=ko\",\"prdName\":\"프레스샷 올인원 토탈 영양 앰플 10개입 (10일분)\",\"prodPrice\":\"25,900\",\"prodCode\":\"A000000181033\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018921613ko.jpg?l=ko\",\"prdName\":\"[슈야&amp;토야] 닥터브라이언 복숭아맛 비타민C&amp;D 3000 100+15구미 기획 (38일분)\",\"prodPrice\":\"13,900\",\"prodCode\":\"A000000189216\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0011/A00000011214511ko.jpg?l=ko\",\"prdName\":\"네이처메이드 슈퍼B 에너지 콤플렉스 180정 (3개월분)\",\"prodPrice\":\"26,400\",\"prodCode\":\"A000000112145\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0020/B00000020671407ko.jpg?l=ko\",\"prdName\":\"GNM 올인원 이뮨 액상 종합비타민 트리플샷 7입 3박스 (21일분)\",\"prodPrice\":\"58,900\",\"prodCode\":\"B000000206714\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018937212ko.jpg?l=ko\",\"prdName\":\"마그랩 포 에너지 글루콘산마그네슘 25ml*10+2입 선물세트\",\"prodPrice\":\"23,900\",\"prodCode\":\"A000000189372\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0014/A00000014696305ko.jpg?l=ko\",\"prdName\":\"허벌랜드 비타민C 구미 60구미 (1개월분)\",\"prodPrice\":\"20,810\",\"prodCode\":\"A000000146963\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0017/A00000017691001ko.jpg?l=ko\",\"prdName\":\"엔젯오리진 에너지 비타민B-컴플렉스 구미(청포도향) 3,000mg 60구미 (30일분)\",\"prodPrice\":\"10,800\",\"prodCode\":\"A000000176910\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0017/A00000017499911ko.jpg?l=ko\",\"prdName\":\"비타바움 비타민B12플러스 브이 컴플렉스 8 (12병입) (12일분)\",\"prodPrice\":\"49,000\",\"prodCode\":\"A000000174999\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0016/A00000016473801ko.jpg?l=ko\",\"prdName\":\"고려은단 비타민C 골드플러스 120정 (120일분)\",\"prodPrice\":\"19,900\",\"prodCode\":\"A000000164738\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0017/A00000017469108ko.jpg?l=ko\",\"prdName\":\"아임비타 면역비타민C 1000 (60포) (30일분)\",\"prodPrice\":\"19,900\",\"prodCode\":\"A000000174691\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018991011ko.jpg?l=ko\",\"prdName\":\"경남 레모나 구미 60구미 (30일분) (멀티비타민+미네랄/루테인+A/비오틴+B) 3 중 택1\",\"prodPrice\":\"10,080\",\"prodCode\":\"A000000189910\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0017/A00000017500009ko.jpg?l=ko\",\"prdName\":\"비타바움 멀티비타민 플러스 브이 컴플렉스 15 (12병입) (12일분)\",\"prodPrice\":\"39,520\",\"prodCode\":\"A000000175000\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0018/A00000018725302ko.jpg?l=ko\",\"prdName\":\"고려은단 메가도스B7 활성비오틴 60정 (2개월분)\",\"prodPrice\":\"14,900\",\"prodCode\":\"A000000187253\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0015/A00000015141004ko.jpg?l=ko\",\"prdName\":\"경남 레모나산 70포 (70일분)\",\"prodPrice\":\"14,800\",\"prodCode\":\"A000000151410\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0019/A00000019143403ko.jpg?l=ko\",\"prdName\":\"프레스샷 마그코어 10개입 (10일분)\",\"prodPrice\":\"35,900\",\"prodCode\":\"A000000191434\"},{\"imgSrc\":\"https://image.oliveyoung.co.kr/uploads/images/goods/400/10/0000/0011/A00000011206821ko.jpg?l=ko\",\"prdName\":\"블랙모어스 칼슘마그네슘 플러스비타민D 60정+60정 (2개월분)\",\"prodPrice\":\"32,500\",\"prodCode\":\"A000000112068\"}]"
let url = "imageDownload.do";
let optionObj = {
	method: 'post',
	headers: {
		'Content-Type': 'application/json' // applicatrion/x-www-form-urlencoded
	},
	body: json
}
document.querySelector('#uploadBtn').onclick = function(e) {
	fetch(url, optionObj) //promise 객체. then(), catch()
		.then(function(result) {
			console.log(result); //Response객체.
			return result.json(); //json문자열로 형태로 반환.
		})
		.then(function(result) {
			console.log(result);
		})
		.catch(function() {
			console.error(err);
		})
}
//옵션 선택
let tbody = document.querySelector('tbody')
let select = document.querySelector('#selectCenter')
select.addEventListener('change', function(e){
select = document.querySelector('#selectCenter').value
tbody.innerHTML= ' ';
	let newAry = centerAry.filter(function(center, idx, ary) {
		return center.sido == select;
	});
	console.log(newAry);
	let field = ['id', 'centerName', 'address', 'phoneNumber']
	newAry.forEach(center => {
		let tr = document.createElement('tr');
		tr.addEventListener('click', function(e){
			//location.href = 'map.jsp?lat=' + center.lat + '&lng=' + center.lng;
			window.open('map.jsp?lat=' + center.lat + '&lng=' + center.lng)
		});
		for (let prop of field) {
			let td = document.createElement('td');
			td.innerHTML = center[prop];
			tr.append(td);
		}
		document.querySelector('tbody').append(tr);
	});
})

//접종센터 정보
let centerAry = [];
console.log('1', centerAry)

url = 'https://api.odcloud.kr/api/15077586/v1/centers?page=1&perPage=284&serviceKey=SOT8I729FnlOqMkBD%2B0j3y8mQgxViCZAJQLhM9aVtqpy3n%2B6q5wjJAFEB6tuAEkPbHNmUZtgjVC1D6r3%2BqCGCA%3D%3D'

console.log('3', centerAry);

let arrayFunc = result => {
	console.log(result);
	centerAry = result.data; // [] 284건.
	console.log('2', centerAry)

	//forEach,map,filter,reduce
	let newAry = centerAry.filter(function(center, idx, ary) {
		return center.sido == select.value;
	});
	console.log(newAry);
	let field = ['id', 'centerName', 'address', 'phoneNumber']
	newAry.forEach(center => {
		let tr = document.createElement('tr');
		tr.addEventListener('click', function(e){
			//location.href = 'map.jsp?lat=' + center.lat + '&lng=' + center.lng;
			window.open('map.jsp?lat=' + center.lat + '&lng=' + center.lng)
		});
		for (let prop of field) {
			let td = document.createElement('td');
			td.innerHTML = center[prop];
			tr.append(td);
		}
		document.querySelector('tbody').append(tr);
	});

} // arrayFunc 끝

fetch(url) //ajax
	.then(result => result.json())
	.then(arrayFunc)
	.catch(err => console.error('에러 =>', err));